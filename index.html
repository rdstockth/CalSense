<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-th="‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ UUC" data-en="UUC Compensation Calculation System">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ UUC</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 );
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 1600px;
            margin: 0 auto;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 );
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 );
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 16px;
        }

        .calibration-points {
            display: grid;
            gap: 20px;
        }

        .point-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .point-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            font-size: 15px;
        }

        .input-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .input-group {
            margin-bottom: 0;
        }

        label {
            display: block;
            color: #555;
            font-weight: 500;
            margin-bottom: 6px;
            font-size: 13px;
        }

        input {
            width: ;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        input[readonly] {
            background: #f0f0f0;
        }

        .locations-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏Å„É≠„Éº„É´‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        }

        table {
            width: ;
            border-collapse: collapse;
            min-width: 600px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏Å„É≠„Éº„É´‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 );
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 13px;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        td input {
            padding: 8px 10px;
            font-size: 13px;
        }

        .btn-calculate-all {
            width: ;
            padding: 14px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 );
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 20px;
            touch-action: manipulation; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        }

        .btn-calculate-all:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(40, 167, 69, 0.4);
        }

        .btn-export {
            padding: 10px 20px;
            background: linear-gradient(135deg, #17a2b8 0%, #138496 );
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            touch-action: manipulation; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        }

        .btn-export:hover {
            opacity: 0.9;
        }

        .formula-display {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.6;
        }

        .formula-display pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
            margin: 10px 0;
        }

        .math {
            text-align: center;
            margin: 10px 0;
        }

        .math-display {
            text-align: center;
            margin: 20px 0;
        }

        .explanation-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #28a745;
            margin-top: 30px;
        }

        .explanation-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .explanation-content {
            font-size: 13px;
            line-height: 1.6;
            color: #555;
        }

        .explanation-table {
            width: ;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .explanation-table th,
        .explanation-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            font-size: 13px;
            transition: background-color 0.2s;
        }

        .explanation-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 );
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .explanation-table tbody tr:nth-child(odd) {
            background: #f8f9ff;
        }

        .explanation-table tbody tr:nth-child(even) {
            background: #fff5f8;
        }

        .explanation-table tbody tr:hover {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 );
            transform: scale(1.01);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        .explanation-table .point-cell {
            font-weight: bold;
            color: #667eea;
            border-right: 2px solid #e0e0e0;
        }

        .explanation-table .value-cell {
            color: #333;
            font-family: 'Courier New', monospace;
        }

        .explanation-table .error-cell {
            color: #d32f2f;
            font-weight: 500;
        }

        .explanation-table .error-cell.positive {
            color: #388e3c;
        }

        .highlight {
            background: #fff3cd;
            animation: highlight 1s ease;
        }

        @keyframes highlight {
            0% { background: #fff3cd; }
             { background: transparent; }
        }

        .chart-section {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #ff9800;
        }

        #errorChart {
            max-height: 400px;
            width: ;
        }

        /* Language Toggle Button */
        .lang-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 );
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: 500;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .lang-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .lang-toggle.active {
            background: linear-gradient(135deg, #28a745 0%, #20c997 );
        }

        /* Media Queries ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ */
        @media (max-width: 1024px) {
            .container {
                padding: 30px;
            }

            h1 {
                font-size: 24px;
            }

            .section-title {
                font-size: 15px;
                padding: 10px 15px;
            }

            .input-row {
                grid-template-columns: repeat(2, 1fr); /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï */
            }

            th, td {
                padding: 10px;
                font-size: 13px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 20px;
                border-radius: 15px;
            }

            h1 {
                font-size: 22px;
            }

            .subtitle {
                font-size: 13px;
            }

            .tabs {
                flex-direction: column;
                gap: 5px;
            }

            .tab {
                width: ;
                padding: 12px;
                font-size: 13px;
            }

            .section-title {
                font-size: 14px;
                padding: 8px 12px;
            }

            .calibration-points {
                gap: 15px;
            }

            .point-group {
                padding: 15px;
            }

            .point-title {
                font-size: 14px;
            }

            .input-row {
                grid-template-columns: 1fr; /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            }

            label {
                font-size: 12px;
            }

            input {
                font-size: 13px;
                padding: 8px 10px;
            }

            th, td {
                padding: 8px 10px;
                font-size: 12px;
            }

            td input {
                font-size: 12px;
                padding: 6px 8px;
            }

            .btn-calculate-all {
                font-size: 15px;
                padding: 12px;
            }

            .btn-export {
                width: ;
                padding: 12px;
                font-size: 13px;
            }

            .formula-display {
                font-size: 12px;
                padding: 12px;
            }

            .formula-display pre {
                font-size: 11px;
            }

            .explanation-table th,
            .explanation-table td {
                padding: 8px 10px;
                font-size: 12px;
            }

            #errorChart {
                max-height: 300px;
            }

            .lang-toggle {
                top: 10px;
                right: 10px;
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 5px;
            }

            .container {
                padding: 15px;
                border-radius: 10px;
            }

            h1 {
                font-size: 20px;
            }

            .subtitle {
                font-size: 12px;
                margin-bottom: 20px;
            }

            .tabs {
                gap: 3px;
            }

            .tab {
                font-size: 12px;
                padding: 10px;
            }

            .section-title {
                font-size: 13px;
                padding: 6px 10px;
            }

            .point-group {
                padding: 12px;
            }

            .point-title {
                font-size: 13px;
                margin-bottom: 10px;
            }

            label {
                font-size: 11px;
                margin-bottom: 4px;
            }

            input {
                font-size: 12px;
                padding: 6px 8px;
            }

            th, td {
                padding: 6px 8px;
                font-size: 11px;
            }

            td input {
                font-size: 11px;
                padding: 4px 6px;
            }

            .btn-calculate-all {
                font-size: 14px;
                padding: 10px;
            }

            .btn-export {
                font-size: 12px;
                padding: 10px;
            }

            .formula-display {
                font-size: 11px;
                padding: 10px;
            }

            .formula-display pre {
                font-size: 10px;
            }

            .explanation-table th,
            .explanation-table td {
                padding: 6px 8px;
                font-size: 11px;
            }

            #errorChart {
                max-height: 250px;
            }

            .lang-toggle {
                top: 5px;
                right: 5px;
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
        }
    </style>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <button class="lang-toggle" id="langToggle" onclick="switchLanguage()">üá∫üá∏</button>
    <div class="container">
        <h1 data-th="üå°Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ UUC" data-en="üå°Ô∏è UUC Compensation Calculation System">üå°Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ UUC</h1>
        <p class="subtitle" data-th="Under Uncertainty of Calibration - Sensor Location Management" data-en="Under Uncertainty of Calibration - Sensor Location Management">Under Uncertainty of Calibration - Sensor Location Management</p>

        <div class="tabs">
            <button class="tab active" data-th="‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Calibration" data-en="‚öôÔ∏è Calibration Setup" onclick="switchTab('calibration')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Calibration</button>
            <button class="tab" data-th="üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏° Location" data-en="üìä Calculate by Location" onclick="switchTab('calculation')">üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏° Location</button>
        </div>

        <!-- Tab: Calibration Setup -->
        <div id="calibration" class="tab-content active">
            <div class="section">
                <div class="section-title" data-th="üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Calibration Points (3 ‡∏à‡∏∏‡∏î)" data-en="üìä Calibration Points Data (3 Points)">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Calibration Points (3 ‡∏à‡∏∏‡∏î)</div>
                
                <div class="calibration-points">
                    <div class="point-group">
                        <div class="point-title" data-th="‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1 (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥)" data-en="Point 1 (Low Temperature)">‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1 (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥)</div>
                        <div class="input-row">
                            <div class="input-group">
                                <label data-th="Mean UUC (¬∞C)" data-en="Mean UUC (¬∞C)">Mean UUC (¬∞C)</label>
                                <input type="number" id="mean1" step="0.001" value="-14.7">
                            </div>
                            <div class="input-group">
                                <label data-th="Standard (¬∞C)" data-en="Standard (¬∞C)">Standard (¬∞C)</label>
                                <input type="number" id="std1" step="0.001" value="-14.942">
                            </div>
                            <div class="input-group">
                                <label data-th="Error" data-en="Error">Error</label>
                                <input type="number" id="err1" step="0.001" value="0.242" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="point-group">
                        <div class="point-title" data-th="‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2 (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Å‡∏•‡∏≤‡∏á)" data-en="Point 2 (Medium Temperature)">‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2 (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Å‡∏•‡∏≤‡∏á)</div>
                        <div class="input-row">
                            <div class="input-group">
                                <label data-th="Mean UUC (¬∞C)" data-en="Mean UUC (¬∞C)">Mean UUC (¬∞C)</label>
                                <input type="number" id="mean2" step="0.001" value="25.2">
                            </div>
                            <div class="input-group">
                                <label data-th="Standard (¬∞C)" data-en="Standard (¬∞C)">Standard (¬∞C)</label>
                                <input type="number" id="std2" step="0.001" value="25.030">
                            </div>
                            <div class="input-group">
                                <label data-th="Error" data-en="Error">Error</label>
                                <input type="number" id="err2" step="0.001" value="0.170" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="point-group">
                        <div class="point-title" data-th="‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 3 (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á)" data-en="Point 3 (High Temperature)">‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 3 (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á)</div>
                        <div class="input-row">
                            <div class="input-group">
                                <label data-th="Mean UUC (¬∞C)" data-en="Mean UUC (¬∞C)">Mean UUC (¬∞C)</label>
                                <input type="number" id="mean3" step="0.001" value="34.9">
                            </div>
                            <div class="input-group">
                                <label data-th="Standard (¬∞C)" data-en="Standard (¬∞C)">Standard (¬∞C)</label>
                                <input type="number" id="std3" step="0.001" value="35.028">
                            </div>
                            <div class="input-group">
                                <label data-th="Error" data-en="Error">Error</label>
                                <input type="number" id="err3" step="0.001" value="-0.128" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="formula-display" id="lagrangeDisplay">
                    <strong data-th="üìê ‡∏™‡∏°‡∏Å‡∏≤‡∏£ Lagrange Polynomial ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏° (Interpolation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3 ‡∏à‡∏∏‡∏î):" data-en="üìê Full Lagrange Polynomial Equation (Interpolation for 3 Points):">üìê ‡∏™‡∏°‡∏Å‡∏≤‡∏£ Lagrange Polynomial ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏° (Interpolation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3 ‡∏à‡∏∏‡∏î):</strong><br>
                    <em data-th="‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤ Error ‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ T ‡πÉ‡∏î‡πÜ ‡πÇ‡∏î‡∏¢‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏∏‡∏î calibration ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏à‡∏∏‡∏î (x‚ÇÅ, y‚ÇÅ), (x‚ÇÇ, y‚ÇÇ), (x‚ÇÉ, y‚ÇÉ)<br> ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà x = Mean UUC (¬∞C), y = Error (¬∞C)" data-en="This equation is used to approximate the Error at any temperature T by passing through all 3 calibration points (x‚ÇÅ, y‚ÇÅ), (x‚ÇÇ, y‚ÇÇ), (x‚ÇÉ, y‚ÇÉ)<br> Where x = Mean UUC (¬∞C), y = Error (¬∞C)">‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤ Error ‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ T ‡πÉ‡∏î‡πÜ ‡πÇ‡∏î‡∏¢‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏∏‡∏î calibration ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏à‡∏∏‡∏î (x‚ÇÅ, y‚ÇÅ), (x‚ÇÇ, y‚ÇÇ), (x‚ÇÉ, y‚ÇÉ)<br>
                    ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà x = Mean UUC (¬∞C), y = Error (¬∞C)</em><br><br>
                    
                    <div id="errorFormula" class="math"></div><br><br>
                    
                    <strong data-th="‡∏ê‡∏≤‡∏ô (Basis Polynomials):" data-en="Basis (Basis Polynomials):">‡∏ê‡∏≤‡∏ô (Basis Polynomials):</strong><br>
                    <div id="L1" class="math"></div>
                    <div id="L2" class="math"></div>
                    <div id="L3" class="math"></div><br><br>
                    
                    <div id="fullFormula" class="math-display"></div>
                    
                    <em><strong data-th="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:" data-en="Note:">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> <span data-th="‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô polynomial ‡∏£‡∏∞‡∏î‡∏±‡∏ö 2 (quadratic) ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á 3 ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Lagrange interpolation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö n+1 ‡∏à‡∏∏‡∏î‡πÉ‡∏´‡πâ polynomial ‡∏£‡∏∞‡∏î‡∏±‡∏ö n." data-en="This equation is a degree 2 polynomial (quadratic) that passes through all 3 points automatically, as Lagrange interpolation for n+1 points yields a degree n polynomial.">‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô polynomial ‡∏£‡∏∞‡∏î‡∏±‡∏ö 2 (quadratic) ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á 3 ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Lagrange interpolation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö n+1 ‡∏à‡∏∏‡∏î‡πÉ‡∏´‡πâ polynomial ‡∏£‡∏∞‡∏î‡∏±‡∏ö n.</span></em>
                </div>

                <!-- New Explanation Section Added Here -->
                <div class="explanation-section">
                    <div class="explanation-title" data-th="üìò ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" data-en="üìò Detailed Calculation Method Explanation">üìò ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</div>
                    <div class="explanation-content">
                        <p><strong data-th="Lagrange Interpolation ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?" data-en="What is Lagrange Interpolation?">Lagrange Interpolation ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</strong></p>
                        <p data-th="Lagrange Interpolation ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô (interpolation) ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡πâ‡∏ß (‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ 3 ‡∏à‡∏∏‡∏î calibration: (x‚ÇÅ, y‚ÇÅ), (x‚ÇÇ, y‚ÇÇ), (x‚ÇÉ, y‚ÇÉ)) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ y ‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ x ‡πÉ‡∏´‡∏°‡πà (T) ‡πÇ‡∏î‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á polynomial ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì coefficients ‡πÅ‡∏ö‡∏ö linear algebra. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ (non-uniform) ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏ú‡∏•‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥  ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3 ‡∏à‡∏∏‡∏î ‡∏à‡∏∞‡πÑ‡∏î‡πâ polynomial ‡∏£‡∏∞‡∏î‡∏±‡∏ö 2 (quadratic curve) ‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡πâ‡∏á‡∏á‡∏≠‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á." data-en="Lagrange Interpolation is a method to approximate a function (interpolation) using known data points (here, 3 calibration points: (x‚ÇÅ, y‚ÇÅ), (x‚ÇÇ, y‚ÇÇ), (x‚ÇÉ, y‚ÇÉ)) to find the y value at a new temperature x (T) by constructing a polynomial that passes directly through all points without solving for coefficients via linear algebra. This method is suitable for non-uniform data and provides  accuracy at known points. For 3 points, it yields a degree 2 polynomial (quadratic curve) that bends according to the actual data.">Lagrange Interpolation ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô (interpolation) ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡πâ‡∏ß (‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ 3 ‡∏à‡∏∏‡∏î calibration: (x‚ÇÅ, y‚ÇÅ), (x‚ÇÇ, y‚ÇÇ), (x‚ÇÉ, y‚ÇÉ)) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ y ‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ x ‡πÉ‡∏´‡∏°‡πà (T) ‡πÇ‡∏î‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á polynomial ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì coefficients ‡πÅ‡∏ö‡∏ö linear algebra. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ (non-uniform) ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏ú‡∏•‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥  ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3 ‡∏à‡∏∏‡∏î ‡∏à‡∏∞‡πÑ‡∏î‡πâ polynomial ‡∏£‡∏∞‡∏î‡∏±‡∏ö 2 (quadratic curve) ‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡πâ‡∏á‡∏á‡∏≠‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á.</p>
                        
                        <p data-th="‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ <strong>Lagrange Interpolation</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Error(T) ‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ ‡πÇ‡∏î‡∏¢ T ‡∏Ñ‡∏∑‡∏≠ Mean UUC (¬∞C) ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö." data-en="The system uses <strong>Lagrange Interpolation</strong> to accurately find Error(T), where T is the Mean UUC (¬∞C) to be adjusted.">‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ <strong>Lagrange Interpolation</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Error(T) ‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ ‡πÇ‡∏î‡∏¢ T ‡∏Ñ‡∏∑‡∏≠ Mean UUC (¬∞C) ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö.</p>
                        
                        <p><strong data-th="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô):" data-en="Data Points Used (Example from Default Values):">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô):</strong></p>
                        <table class="explanation-table">
                            <thead>
                                <tr>
                                    <th data-th="‡∏à‡∏∏‡∏î" data-en="Point">‡∏à‡∏∏‡∏î</th>
                                    <th data-th="Mean UUC (¬∞C) (x)" data-en="Mean UUC (¬∞C) (x)">Mean UUC (¬∞C) (x)</th>
                                    <th data-th="Error (¬∞C) (y)" data-en="Error (¬∞C) (y)">Error (¬∞C) (y)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="point-cell" data-th="1 (‡∏ï‡πà‡∏≥)" data-en="1 (Low)">1 (‡∏ï‡πà‡∏≥)</td>
                                    <td class="value-cell">-14.7</td>
                                    <td class="error-cell positive">0.242</td>
                                </tr>
                                <tr>
                                    <td class="point-cell" data-th="2 (‡∏Å‡∏•‡∏≤‡∏á)" data-en="2 (Medium)">2 (‡∏Å‡∏•‡∏≤‡∏á)</td>
                                    <td class="value-cell">25.2</td>
                                    <td class="error-cell positive">0.170</td>
                                </tr>
                                <tr>
                                    <td class="point-cell" data-th="3 (‡∏™‡∏π‡∏á)" data-en="3 (High)">3 (‡∏™‡∏π‡∏á)</td>
                                    <td class="value-cell">34.9</td>
                                    <td class="error-cell">-0.128</td>
                                </tr>
                            </tbody>
                        </table>

                        <p><strong data-th="‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Error(T) ‡πÉ‡∏ô calculateError (Lagrange Direct):" data-en="Steps to Calculate Error(T) in calculateError (Lagrange Direct):">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Error(T) ‡πÉ‡∏ô calculateError (Lagrange Direct):</strong></p>
                        <ol style="font-size: 12px; margin: 10px 0; padding-left: 20px;">
                            <li data-th="L‚ÇÅ(T) = [(T - x‚ÇÇ)(T - x‚ÇÉ)] / [(x‚ÇÅ - x‚ÇÇ)(x‚ÇÅ - x‚ÇÉ)] <br><em>‡πÇ‡∏î‡∏¢ x‚ÇÅ = Mean UUC ‡∏à‡∏∏‡∏î 1, x‚ÇÇ = Mean UUC ‡∏à‡∏∏‡∏î 2, x‚ÇÉ = Mean UUC ‡∏à‡∏∏‡∏î 3, T = Mean UUC ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö</em>" data-en="L‚ÇÅ(T) = [(T - x‚ÇÇ)(T - x‚ÇÉ)] / [(x‚ÇÅ - x‚ÇÇ)(x‚ÇÅ - x‚ÇÉ)] <br><em>Where x‚ÇÅ = Mean UUC Point 1, x‚ÇÇ = Mean UUC Point 2, x‚ÇÉ = Mean UUC Point 3, T = Mean UUC to adjust</em>">L‚ÇÅ(T) = [(T - x‚ÇÇ)(T - x‚ÇÉ)] / [(x‚ÇÅ - x‚ÇÇ)(x‚ÇÅ - x‚ÇÉ)] <br><em>‡πÇ‡∏î‡∏¢ x‚ÇÅ = Mean UUC ‡∏à‡∏∏‡∏î 1, x‚ÇÇ = Mean UUC ‡∏à‡∏∏‡∏î 2, x‚ÇÉ = Mean UUC ‡∏à‡∏∏‡∏î 3, T = Mean UUC ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö</em></li>
                            <li data-th="L‚ÇÇ(T) = [(T - x‚ÇÅ)(T - x‚ÇÉ)] / [(x‚ÇÇ - x‚ÇÅ)(x‚ÇÇ - x‚ÇÉ)] <br><em>L‚ÇÇ ‡∏Ñ‡∏∑‡∏≠ Basis Polynomial ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏∏‡∏î 2</em>" data-en="L‚ÇÇ(T) = [(T - x‚ÇÅ)(T - x‚ÇÉ)] / [(x‚ÇÇ - x‚ÇÅ)(x‚ÇÇ - x‚ÇÉ)] <br><em>L‚ÇÇ is the Basis Polynomial for Point 2</em>">L‚ÇÇ(T) = [(T - x‚ÇÅ)(T - x‚ÇÉ)] / [(x‚ÇÇ - x‚ÇÅ)(x‚ÇÇ - x‚ÇÉ)] <br><em>L‚ÇÇ ‡∏Ñ‡∏∑‡∏≠ Basis Polynomial ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏∏‡∏î 2</em></li>
                            <li data-th="L‚ÇÉ(T) = [(T - x‚ÇÅ)(T - x‚ÇÇ)] / [(x‚ÇÉ - x‚ÇÅ)(x‚ÇÉ - x‚ÇÇ)] <br><em>L‚ÇÉ ‡∏Ñ‡∏∑‡∏≠ Basis Polynomial ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏∏‡∏î 3</em>" data-en="L‚ÇÉ(T) = [(T - x‚ÇÅ)(T - x‚ÇÇ)] / [(x‚ÇÉ - x‚ÇÅ)(x‚ÇÉ - x‚ÇÇ)] <br><em>L‚ÇÉ is the Basis Polynomial for Point 3</em>">L‚ÇÉ(T) = [(T - x‚ÇÅ)(T - x‚ÇÇ)] / [(x‚ÇÉ - x‚ÇÅ)(x‚ÇÉ - x‚ÇÇ)] <br><em>L‚ÇÉ ‡∏Ñ‡∏∑‡∏≠ Basis Polynomial ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏∏‡∏î 3</em></li>
                            <li data-th="Error(T) = y‚ÇÅ L‚ÇÅ + y‚ÇÇ L‚ÇÇ + y‚ÇÉ L‚ÇÉ <br><em>‡πÇ‡∏î‡∏¢ y‚ÇÅ = Error ‡∏à‡∏∏‡∏î 1, y‚ÇÇ = Error ‡∏à‡∏∏‡∏î 2, y‚ÇÉ = Error ‡∏à‡∏∏‡∏î 3</em>" data-en="Error(T) = y‚ÇÅ L‚ÇÅ + y‚ÇÇ L‚ÇÇ + y‚ÇÉ L‚ÇÉ <br><em>Where y‚ÇÅ = Error Point 1, y‚ÇÇ = Error Point 2, y‚ÇÉ = Error Point 3</em>">Error(T) = y‚ÇÅ L‚ÇÅ + y‚ÇÇ L‚ÇÇ + y‚ÇÉ L‚ÇÉ <br><em>‡πÇ‡∏î‡∏¢ y‚ÇÅ = Error ‡∏à‡∏∏‡∏î 1, y‚ÇÇ = Error ‡∏à‡∏∏‡∏î 2, y‚ÇÉ = Error ‡∏à‡∏∏‡∏î 3</em></li>
                        </ol>

                        <p><em data-th="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: Adjustment = Error(T), ‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏±‡∏ö = T - Adjustment. ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥  ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î calibration. ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á -15¬∞C ‡∏ñ‡∏∂‡∏á 35¬∞C." data-en="Note: Adjustment = Error(T), Adjusted Value = T - Adjustment.  accurate at calibration points. Recommended for use in the range -15¬∞C to 35¬∞C.">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: Adjustment = Error(T), ‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏±‡∏ö = T - Adjustment. ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥  ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î calibration. ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á -15¬∞C ‡∏ñ‡∏∂‡∏á 35¬∞C.</em></p>
                    </div>
                </div>

                <!-- New Chart Section -->
                <div class="chart-section">
                    <div class="section-title" data-th="üìà ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ Error ‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (-15¬∞C ‡∏ñ‡∏∂‡∏á 35¬∞C)" data-en="üìà Graph Showing Error Values Across Temperature Range (-15¬∞C to 35¬∞C)">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ Error ‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (-15¬∞C ‡∏ñ‡∏∂‡∏á 35¬∞C)</div>
                    <canvas id="errorChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tab: Calculation by Location -->
        <div id="calculation" class="tab-content">
            <div class="section">
                <div class="section-title" data-th="üìç ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Adjustment ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° Sensor Location" data-en="üìç Calculate Adjustment by Sensor Location">üìç ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Adjustment ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° Sensor Location</div>
                
                <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #4caf50;">
                    <strong data-th="üìù ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:" data-en="üìù How to Use:">üìù ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</strong><br>
                    <span data-th="1. ‡∏Å‡∏£‡∏≠‡∏Å &quot;‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ&quot; ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î&lt;br&gt;2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì &quot;Adjustment&quot; (‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢) ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥&lt;br&gt;3. ‡πÅ‡∏™‡∏î‡∏á &quot;‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á Adjust&quot; (‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á) = ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ - Adjustment" data-en="1. Enter the &quot;Measured Value&quot; from the measuring instrument&lt;br&gt;2. The system will automatically calculate &quot;Adjustment&quot; (compensation value)&lt;br&gt;3. Display &quot;Adjusted Value&quot; (true value) = Measured Value - Adjustment">1. ‡∏Å‡∏£‡∏≠‡∏Å &quot;‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ&quot; ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î<br>2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì &quot;Adjustment&quot; (‡∏Ñ‡πà‡∏≤‡∏ä‡∏î‡πÄ‡∏ä‡∏¢) ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥<br>3. ‡πÅ‡∏™‡∏î‡∏á &quot;‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á Adjust&quot; (‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á) = ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ - Adjustment</span>
                </div>
                
                <div class="locations-table">
                    <table id="locationsTable">
                        <thead>
                            <tr>
                                <th style="width: 5%;" data-th="#" data-en="#">#</th>
                                <th style="width: 30%;" data-th="Sensor Location" data-en="Sensor Location">Sensor Location</th>
                                <th style="width: 20%;" data-th="‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ (¬∞C)" data-en="Measured Value (¬∞C)">‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ (¬∞C)</th>
                                <th style="width: 22.5%;" data-th="Adjustment" data-en="Adjustment">Adjustment</th>
                                <th style="width: 22.5%;" data-th="‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á Adjust (¬∞C)" data-en="Adjusted Value (¬∞C)">‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á Adjust (¬∞C)</th>
                            </tr>
                        </thead>
                        <tbody id="locationsBody">
                        </tbody>
                    </table>
                </div>

                <button class="btn-calculate-all" data-th="üîÑ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" data-en="üîÑ Calculate All" onclick="calculateAll()">üîÑ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="btn-export" data-th="üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV" data-en="üì• Download CSV" onclick="exportToCSV()">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV</button>
            </div>
        </div>
    </div>

    <script>
        const locations = [
            "Coating room S1",
            "Coating room S2",
            "PCM high index S1",
            "PCM high index S2",
            "Clean room S1",
            "Clean room S2",
            "Casting area",
            "PMG room",
            "Server room",
            "Mixing room 1.5",
            "Monomer Stock 1.6",
            "Monomer Stock PCM",
            "Monomer Stock 1.5",
            "Ring production",
            "Mixing room 1.6",
            "Clean room S1",
            "Clean room S2",
            "Casting area",
            "Polymerization area",
            "Product cleaning area",
            "Mould cleaning area",
            "Color check room",
            "Qc area",
            "Server room"
        ];

        let errorChart;
        let currentLang = 'th'; // Default to Thai

        // Language texts for alerts and placeholders
        const langTexts = {
            th: {
                placeholder: '‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ',
                alertCalibration: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Calibration Points ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Calibration"',
                alertNoData: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
                alertCalculated: '‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô! ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô {count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
                csvHeader: 'No,Sensor Location,‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ (¬∞C),Adjustment,‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á Adjust (¬∞C)\n'
            },
            en: {
                placeholder: 'Enter measured value',
                alertCalibration: 'Please complete the Calibration Points data in the "Calibration Setup" tab',
                alertNoData: 'Please enter at least 1 measured value',
                alertCalculated: 'Calculation complete! {count} items processed',
                csvHeader: 'No,Sensor Location,Measured Value (¬∞C),Adjustment,Adjusted Value (¬∞C)\n'
            }
        };

        // Function to switch language
        function switchLanguage() {
            currentLang = currentLang === 'th' ? 'en' : 'th';
            const elements = document.querySelectorAll('[data-th], [data-en]');
            elements.forEach(el => {
                if (el.hasAttribute('data-th') && el.hasAttribute('data-en')) {
                    el.innerHTML = currentLang === 'th' ? el.dataset.th : el.dataset.en;
                }
            });
            const toggleBtn = document.getElementById('langToggle');
            toggleBtn.textContent = currentLang === 'th' ? 'üá∫üá∏' : 'üáπüá≠';
            toggleBtn.classList.toggle('active', currentLang === 'en');
            // Update placeholders and other dynamic texts
            updateDynamicTexts();
            // Re-render MathJax and chart if needed
            if (document.getElementById('calibration').classList.contains('active')) {
                updateLagrangeFormula();
                typesetMath();
                updateChart();
            }
        }

        function updateDynamicTexts() {
            const inputs = document.querySelectorAll('input[placeholder]');
            inputs.forEach(input => {
                input.placeholder = langTexts[currentLang].placeholder;
            });
            // Update table headers if needed (already handled by data attributes)
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function initializeTable() {
            const tbody = document.getElementById('locationsBody');
            tbody.innerHTML = '';
            
            locations.forEach((location, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><strong>${location}</strong></td>
                    <td><input type="number" step="0.01" id="measured_${index}" placeholder="${langTexts[currentLang].placeholder}" onchange="calculateSingle(${index})"></td>
                    <td><input type="number" step="0.001" id="adjustment_${index}" readonly style="background: #fff3cd; font-weight: 600;"></td>
                    <td><input type="number" step="0.001" id="adjusted_${index}" readonly style="background: #d4edda; font-weight: 600;"></td>
                `;
                tbody.appendChild(row);
            });
        }

        // ‡∏£‡∏≠ MathJax load
        function waitForMathJax() {
            return new Promise((resolve) => {
                if (window.MathJax && window.MathJax.typesetPromise) {
                    resolve();
                } else {
                    const observer = new MutationObserver(() => {
                        if (window.MathJax && window.MathJax.typesetPromise) {
                            observer.disconnect();
                            resolve();
                        }
                    });
                    observer.observe(document.body, { childList: true, subtree: true });
                }
            });
        }

        async function typesetMath() {
            try {
                await waitForMathJax();
                await MathJax.typesetPromise();
            } catch (error) {
                console.error('MathJax typeset error:', error);
            }
        }

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü Line Chart
        function updateChart() {
            const x1 = parseFloat(document.getElementById('mean1').value);
            const y1 = parseFloat(document.getElementById('err1').value);
            const x2 = parseFloat(document.getElementById('mean2').value);
            const y2 = parseFloat(document.getElementById('err2').value);
            const x3 = parseFloat(document.getElementById('mean3').value);
            const y3 = parseFloat(document.getElementById('err3').value);

            if (isNaN(x1) || isNaN(y1) || isNaN(x2) || isNaN(y2) || isNaN(x3) || isNaN(y3)) {
                return;
            }

            const temperatures = [];
            const errors = [];
            for (let t = -15; t <= 35; t += 1) {
                temperatures.push(t);
                errors.push(calculateError(t, x1, y1, x2, y2, x3, y3));
            }

            const ctx = document.getElementById('errorChart').getContext('2d');
            if (errorChart) {
                errorChart.destroy();
            }

            const chartTitle = currentLang === 'th' ? 'Error Curve from Lagrange Interpolation (-15¬∞C to 35¬∞C)' : 'Error Curve from Lagrange Interpolation (-15¬∞C to 35¬∞C)';
            const xLabel = currentLang === 'th' ? 'Mean UUC (¬∞C)' : 'Mean UUC (¬∞C)';
            const yLabel = currentLang === 'th' ? 'Error (¬∞C)' : 'Error (¬∞C)';

            errorChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: temperatures,
                    datasets: [{
                        label: currentLang === 'th' ? 'Error (¬∞C)' : 'Error (¬∞C)',
                        data: errors,
                        borderColor: 'rgb(102, 126, 234)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0,
                        pointHoverRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: xLabel
                            },
                            min: -15,
                            max: 35
                        },
                        y: {
                            title: {
                                display: true,
                                text: yLabel
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: chartTitle
                        },
                        legend: {
                            display: true
                        }
                    }
                }
            });
        }

        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Error ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        function updateError(pointNum) {
            const mean = parseFloat(document.getElementById('mean' + pointNum).value);
            const std = parseFloat(document.getElementById('std' + pointNum).value);
            if (!isNaN(mean) && !isNaN(std)) {
                const error = mean - std;
                document.getElementById('err' + pointNum).value = error.toFixed(3);
                updateLagrangeFormula();
                updateChart();
                typesetMath();
            }
        }

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏°‡∏Å‡∏≤‡∏£ Lagrange ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°
        async function updateLagrangeFormula() {
            const x1 = parseFloat(document.getElementById('mean1').value);
            const y1 = parseFloat(document.getElementById('err1').value);
            const x2 = parseFloat(document.getElementById('mean2').value);
            const y2 = parseFloat(document.getElementById('err2').value);
            const x3 = parseFloat(document.getElementById('mean3').value);
            const y3 = parseFloat(document.getElementById('err3').value);

            if (!isNaN(x1) && !isNaN(y1) && !isNaN(x2) && !isNaN(y2) && !isNaN(x3) && !isNaN(y3)) {
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì denominator ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö L1, L2, L3
                const L1_den = (x1 - x2) * (x1 - x3);
                const L2_den = (x2 - x1) * (x2 - x3);
                const L3_den = (x3 - x1) * (x3 - x2);

                const x1_str = x1.toFixed(3);
                const x2_str = x2.toFixed(3);
                const x3_str = x3.toFixed(3);
                const y1_str = y1.toFixed(3);
                const y2_str = y2.toFixed(3);
                const y3_str = y3.toFixed(3);
                const L1_den_str = L1_den.toFixed(6);
                const L2_den_str = L2_den.toFixed(6);
                const L3_den_str = L3_den.toFixed(6);

                const errorFormulaText = `\\text{Error}(T) = ${y1_str} \\cdot L_1(T) + ${y2_str} \\cdot L_2(T) + ${y3_str} \\cdot L_3(T)`;

                const L1Text = `L_1(T) = \\frac{(T - ${x2_str})(T - ${x3_str}) }{ ${L1_den_str} }`;

                const L2Text = `L_2(T) = \\frac{(T - ${x1_str})(T - ${x3_str}) }{ ${L2_den_str} }`;

                const L3Text = `L_3(T) = \\frac{(T - ${x1_str})(T - ${x2_str}) }{ ${L3_den_str} }`;

                const den1 = `(${x1_str} - ${x2_str})(${x1_str} - ${x3_str})`;
                const den2 = `(${x2_str} - ${x1_str})(${x2_str} - ${x3_str})`;
                const den3 = `(${x3_str} - ${x1_str})(${x3_str} - ${x2_str})`;

                const fullFormulaText = currentLang === 'th' ? 
                    `\\begin{align*}\\text{Error}(T) &= ${y1_str} \\times \\frac{(T - ${x2_str})(T - ${x3_str}) }{ ${den1} } + ${y2_str} \\times \\frac{(T - ${x1_str})(T - ${x3_str}) }{ ${den2} } + ${y3_str} \\times \\frac{(T - ${x1_str})(T - ${x2_str}) }{ ${den3} } \\\\ \\text{‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏±‡∏ö (Standard Value)} &= T - \\text{Error}(T)\\end{align*}` :
                    `\\begin{align*}\\text{Error}(T) &= ${y1_str} \\times \\frac{(T - ${x2_str})(T - ${x3_str}) }{ ${den1} } + ${y2_str} \\times \\frac{(T - ${x1_str})(T - ${x3_str}) }{ ${den2} } + ${y3_str} \\times \\frac{(T - ${x1_str})(T - ${x2_str}) }{ ${den3} } \\\\ \\text{Adjusted Value (Standard Value)} &= T - \\text{Error}(T)\\end{align*}`;

                document.getElementById('L1').innerHTML = `\\[ ${L1Text} \\]`;
                document.getElementById('L2').innerHTML = `\\[ ${L2Text} \\]`;
                document.getElementById('L3').innerHTML = `\\[ ${L3Text} \\]`;

                document.getElementById('errorFormula').innerHTML = `\\[ ${errorFormulaText} \\]`;

                document.getElementById('fullFormula').innerHTML = `\\[ ${fullFormulaText} \\]`;

                await typesetMath();
            }
        }

        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Error ‡∏î‡πâ‡∏ß‡∏¢ Lagrange Interpolation
        function calculateError(T, x1, y1, x2, y2, x3, y3) {
            const L1 = ((T - x2) * (T - x3)) / ((x1 - x2) * (x1 - x3));
            const L2 = ((T - x1) * (T - x3)) / ((x2 - x1) * (x2 - x3));
            const L3 = ((T - x1) * (T - x2)) / ((x3 - x1) * (x3 - x2));
            return y1 * L1 + y2 * L2 + y3 * L3;
        }

        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
        function calculateSingle(index) {
            const x1 = parseFloat(document.getElementById('mean1').value);
            const y1 = parseFloat(document.getElementById('err1').value);
            const x2 = parseFloat(document.getElementById('mean2').value);
            const y2 = parseFloat(document.getElementById('err2').value);
            const x3 = parseFloat(document.getElementById('mean3').value);
            const y3 = parseFloat(document.getElementById('err3').value);

            if (isNaN(x1) || isNaN(y1) || isNaN(x2) || isNaN(y2) || isNaN(x3) || isNaN(y3)) {
                alert(langTexts[currentLang].alertCalibration);
                return;
            }

            const measured = parseFloat(document.getElementById(`measured_${index}`).value);
            
            if (!isNaN(measured)) {
                const adjustment = calculateError(measured, x1, y1, x2, y2, x3, y3);
                const adjusted = measured - adjustment;
                
                document.getElementById(`adjustment_${index}`).value = adjustment.toFixed(3);
                document.getElementById(`adjusted_${index}`).value = adjusted.toFixed(3);
                
                // Highlight effect
                document.getElementById(`adjusted_${index}`).parentElement.classList.add('highlight');
                setTimeout(() => {
                    document.getElementById(`adjusted_${index}`).parentElement.classList.remove('highlight');
                }, 1000);
            }
        }

        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function calculateAll() {
            const x1 = parseFloat(document.getElementById('mean1').value);
            const y1 = parseFloat(document.getElementById('err1').value);
            const x2 = parseFloat(document.getElementById('mean2').value);
            const y2 = parseFloat(document.getElementById('err2').value);
            const x3 = parseFloat(document.getElementById('mean3').value);
            const y3 = parseFloat(document.getElementById('err3').value);

            if (isNaN(x1) || isNaN(y1) || isNaN(x2) || isNaN(y2) || isNaN(x3) || isNaN(y3)) {
                alert(langTexts[currentLang].alertCalibration);
                return;
            }

            let calculated = 0;
            locations.forEach((location, index) => {
                const measured = parseFloat(document.getElementById(`measured_${index}`).value);
                
                if (!isNaN(measured)) {
                    const adjustment = calculateError(measured, x1, y1, x2, y2, x3, y3);
                    const adjusted = measured - adjustment;
                    
                    document.getElementById(`adjustment_${index}`).value = adjustment.toFixed(3);
                    document.getElementById(`adjusted_${index}`).value = adjusted.toFixed(3);
                    
                    // Highlight effect
                    document.getElementById(`adjusted_${index}`).parentElement.classList.add('highlight');
                    setTimeout(() => {
                        document.getElementById(`adjusted_${index}`).parentElement.classList.remove('highlight');
                    }, 1000);
                    
                    calculated++;
                }
            });

            if (calculated === 0) {
                alert(langTexts[currentLang].alertNoData);
            } else {
                alert(langTexts[currentLang].alertCalculated.replace('{count}', calculated));
            }
        }

        // Export to CSV
        function exportToCSV() {
            let csv = langTexts[currentLang].csvHeader;
            
            locations.forEach((location, index) => {
                const measured = document.getElementById(`measured_${index}`).value || '';
                const adjustment = document.getElementById(`adjustment_${index}`).value || '';
                const adjusted = document.getElementById(`adjusted_${index}`).value || '';
                csv += `${index + 1},"${location}",${measured},${adjustment},${adjusted}\n`;
            });

            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', currentLang === 'th' ? 'UUC_Adjustment_Results.csv' : 'UUC_Adjustment_Results.csv');
            link.click();
        }

        // Switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Event listeners
        for (let i = 1; i <= 3; i++) {
            document.getElementById('mean' + i).addEventListener('input', () => updateError(i));
            document.getElementById('std' + i).addEventListener('input', () => updateError(i));
        }

        // Initialize
        initializeTable();
        updateError(1);
        updateError(2);
        updateError(3);
        updateChart();
    </script>
</body>
</html>

